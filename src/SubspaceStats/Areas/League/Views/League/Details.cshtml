@using Microsoft.Extensions.Options
@using SubspaceStats.Areas.League.Models.League
@using SubspaceStats.Options
@model LeagueDetailsViewModel
@inject IOptions<LeagueOptions> leagueOptions

@{
    ViewData["Title"] = "League Details";

    Model.GameTypes.TryGetValue(Model.League.GameType, out string? gameTypeName);
}

<h1>League Details</h1>

<div class="mb-3">
    <a asp-action="Index" class="mx-2">Back to League List</a>
    <a asp-action="Edit" asp-route-id="@Model.League.Id" class="mx-2">Edit</a>
</div>

<div class="container">
    <div class="row">
        <div class="col">
            <div class="mb-3">
                <label asp-for="League.Id" class="form-label"></label>
                @Html.DisplayFor(model => model.League.Id)
                <label class="form-control">@Model.League.Id</label>
            </div>
            <div class="mb-3">
                <label asp-for="League.Name" class="form-label"></label>
                @Html.DisplayFor(model => model.League.Name)
            </div>
            <div class="mb-3">
                <label asp-for="League.GameType" class="form-label"></label>
                <label class="form-control">@gameTypeName</label>
            </div>
        </div>
    </div>
</div>

<h2>Seasons</h2>

<div class="mb-3">
    <a asp-controller="Season" asp-action="Create">New Season</a>
</div>

<div class="table-responsive">
	<table class="table table-striped table-bordered table-hover">
		<thead>
			<tr>
				<th class="text-end">ID</th>
				<th>Name</th>
				<th>Created</th>
				<th colspan="3">Actions</th>
			</tr>
		</thead>
		<tbody>
			@foreach (var season in Model.Seasons)
			{
				<tr>
					<td class="text-end">@season.Id</td>
					<td><a asp-controller="Season" asp-action="Index" asp-route-id="@season.Id" class="link-underline link-underline-opacity-0 link-underline-opacity-75-hover">@season.Name</a></td>
                    <td>@TimeZoneInfo.ConvertTimeFromUtc(season.CreatedTimestamp, leagueOptions.Value.TimeZone).ToString("yyyy-MM-dd HH:mm:ss")</td>
					<td><a asp-controller="Season" asp-action="Edit" asp-route-id="@season.Id">Edit</a></td>
                    <td><a asp-controller="Season" asp-action="Copy" asp-route-id="@season.Id">Copy</a></td>
					<td><a asp-controller="Season" asp-action="Delete" asp-route-id="@season.Id">Delete</a></td>
				</tr>
			}
		</tbody>
	</table>
</div>
